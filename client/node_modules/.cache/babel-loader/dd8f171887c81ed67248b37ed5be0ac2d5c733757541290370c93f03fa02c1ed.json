{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useImperativeHandle, useMemo, useRef } from \"react\";\nimport { useSyncExternalStore } from \"use-sync-external-store/shim\";\nimport { DataUpdatesContext, DndContext, NodesContext, TreeApiContext } from \"../context\";\nimport { TreeApi } from \"../interfaces/tree-api\";\nimport { initialState } from \"../state/initial\";\nimport { rootReducer } from \"../state/root-reducer\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport { DndProvider } from \"react-dnd\";\nimport { createStore } from \"redux\";\nimport { actions as visibility } from \"../state/open-slice\";\nconst SERVER_STATE = initialState();\nexport function TreeProvider({\n  treeProps,\n  imperativeHandle,\n  children\n}) {\n  const list = useRef(null);\n  const listEl = useRef(null);\n  const store = useRef(\n  // @ts-ignore\n  createStore(rootReducer, initialState(treeProps)));\n  const state = useSyncExternalStore(store.current.subscribe, store.current.getState, () => SERVER_STATE);\n  /* The tree api object is stable. */\n  const api = useMemo(() => {\n    return new TreeApi(store.current, treeProps, list, listEl);\n  }, []);\n  /* Make sure the tree instance stays in sync */\n  const updateCount = useRef(0);\n  useMemo(() => {\n    updateCount.current += 1;\n    api.update(treeProps);\n  }, [...Object.values(treeProps), state.nodes.open]);\n  /* Expose the tree api */\n  useImperativeHandle(imperativeHandle, () => api);\n  /* Change selection based on props */\n  useEffect(() => {\n    if (api.props.selection) {\n      api.select(api.props.selection, {\n        focus: false\n      });\n    } else {\n      api.deselectAll();\n    }\n  }, [api.props.selection]);\n  /* Clear visability for filtered nodes */\n  useEffect(() => {\n    if (!api.props.searchTerm) {\n      store.current.dispatch(visibility.clear(true));\n    }\n  }, [api.props.searchTerm]);\n  return _jsx(TreeApiContext.Provider, {\n    value: api,\n    children: _jsx(DataUpdatesContext.Provider, {\n      value: updateCount.current,\n      children: _jsx(NodesContext.Provider, {\n        value: state.nodes,\n        children: _jsx(DndContext.Provider, {\n          value: state.dnd,\n          children: _jsx(DndProvider, Object.assign({\n            backend: HTML5Backend,\n            options: {\n              rootElement: api.props.dndRootElement || undefined\n            }\n          }, treeProps.dndManager && {\n            manager: treeProps.dndManager\n          }, {\n            children: children\n          }))\n        })\n      })\n    })\n  });\n}","map":{"version":3,"names":["jsx","_jsx","useEffect","useImperativeHandle","useMemo","useRef","useSyncExternalStore","DataUpdatesContext","DndContext","NodesContext","TreeApiContext","TreeApi","initialState","rootReducer","HTML5Backend","DndProvider","createStore","actions","visibility","SERVER_STATE","TreeProvider","treeProps","imperativeHandle","children","list","listEl","store","state","current","subscribe","getState","api","updateCount","update","Object","values","nodes","open","props","selection","select","focus","deselectAll","searchTerm","dispatch","clear","Provider","value","dnd","assign","backend","options","rootElement","dndRootElement","undefined","dndManager","manager"],"sources":["/Users/yuri/GitHub/ECL_Website/root/seminar/client/node_modules/react-arborist/dist/module/components/provider.js"],"sourcesContent":["import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useImperativeHandle, useMemo, useRef, } from \"react\";\nimport { useSyncExternalStore } from \"use-sync-external-store/shim\";\nimport { DataUpdatesContext, DndContext, NodesContext, TreeApiContext, } from \"../context\";\nimport { TreeApi } from \"../interfaces/tree-api\";\nimport { initialState } from \"../state/initial\";\nimport { rootReducer } from \"../state/root-reducer\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport { DndProvider } from \"react-dnd\";\nimport { createStore } from \"redux\";\nimport { actions as visibility } from \"../state/open-slice\";\nconst SERVER_STATE = initialState();\nexport function TreeProvider({ treeProps, imperativeHandle, children, }) {\n    const list = useRef(null);\n    const listEl = useRef(null);\n    const store = useRef(\n    // @ts-ignore\n    createStore(rootReducer, initialState(treeProps)));\n    const state = useSyncExternalStore(store.current.subscribe, store.current.getState, () => SERVER_STATE);\n    /* The tree api object is stable. */\n    const api = useMemo(() => {\n        return new TreeApi(store.current, treeProps, list, listEl);\n    }, []);\n    /* Make sure the tree instance stays in sync */\n    const updateCount = useRef(0);\n    useMemo(() => {\n        updateCount.current += 1;\n        api.update(treeProps);\n    }, [...Object.values(treeProps), state.nodes.open]);\n    /* Expose the tree api */\n    useImperativeHandle(imperativeHandle, () => api);\n    /* Change selection based on props */\n    useEffect(() => {\n        if (api.props.selection) {\n            api.select(api.props.selection, { focus: false });\n        }\n        else {\n            api.deselectAll();\n        }\n    }, [api.props.selection]);\n    /* Clear visability for filtered nodes */\n    useEffect(() => {\n        if (!api.props.searchTerm) {\n            store.current.dispatch(visibility.clear(true));\n        }\n    }, [api.props.searchTerm]);\n    return (_jsx(TreeApiContext.Provider, { value: api, children: _jsx(DataUpdatesContext.Provider, { value: updateCount.current, children: _jsx(NodesContext.Provider, { value: state.nodes, children: _jsx(DndContext.Provider, { value: state.dnd, children: _jsx(DndProvider, Object.assign({ backend: HTML5Backend, options: { rootElement: api.props.dndRootElement || undefined } }, (treeProps.dndManager && { manager: treeProps.dndManager }), { children: children })) }) }) }) }));\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}